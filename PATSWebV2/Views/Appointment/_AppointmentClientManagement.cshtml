@using Kendo.Mvc.UI;
@model PATSWebV2.ViewModels.AppointmentViewModel
<style>
    .k-tabstrip .k-content.k-state-active,.k-tabstrip-items  {
        padding: 0px;
        /*background-color: #E6E6FA !important;*/
    }
    .k-tabstrip-items .k-item {
        height: 25px;
        font-size: 13px;
        font-weight: bolder;
        /*background-color: #E6E6FA;*/
    }

    #asstTabstrip {
        margin: 0;
        border-width: 0;
        height: 100vh; /* DO NOT USE !important for setting the Grid height!*/
    }

    /*.k-grid tr td {
        line-height: 18px !important;
        min-height: 18px !important;
        height: 18px !important;
        font-size: 14px;
        border-bottom: 0.5px solid silver !important;
    }*/
    .k-tabstrip-wrapper{
        width:100%;
        height:95%;
    }
    #appttabstrip{
        margin: 0;
        padding: 0;
        border-width: 0;
        height: 100%; /* DO NOT USE !important for setting the Grid height! */
    }

    #appttabstrip-1 {
        min-height: 68VH !important;
        overflow:hidden;
    }
</style>

<script>
    $("#loading").hide();
    $(document).ready(function () {
        var days = parseInt($("#hdAppointmentDay").val());
        if (days > 0 || $("#hdSelectTab").val() == "1") {
            var tabStrip = $("#appttabstrip").kendoTabStrip().data("kendoTabStrip");   // Grab the Tab Strip
            tabStrip.select(1);                                                   // Set the Selected Tab
        }
    });
</script>
@*<div id="appointmentdiv">*@
    @Html.HiddenFor(m=>m.CanEdit, new { id= "hdApptEditable" } )
    @Html.HiddenFor(m => m.ClientLocationId, new { id = "hdClientLocationId" })
    @Html.HiddenFor(m => m.AppointmentDay, new { id = "hdAppointmentDay" })
    @Html.HiddenFor(m => m.SelectTab, new { id = "hdSelectTab" })
    <script>
        function tabChanged(e) {
           WaitDialog(1);
           if (e.item.textContent == "Back to Social Work") {
                url = '@Url.Action("GetSocialWork", "Client")';
                fndata = { EpisodeID: $("#AllSelectedOffenderEpisodeResult").val(), ActiveTabIn:"ReEntry" };
                LoadSelectedTab(url, fndata, "#viewPlaceHolder");
            }
            else if (e.item.textContent == "Back to dashboard") {
                url = '@Url.Action("GetEditingPaneBack", "Client")';
                fndata = { EpisodeID: $("#AllSelectedOffenderEpisodeResult").val() };
                LoadSelectedTab(url, fndata, "#editingpane");
            }
            else
                reloadTab(e);

            WaitDialog(0);
        }
        function reloadTab(e) {
            $('#appttabstrip').data('kendoTabStrip').reload(e.item);
        }

     function getGridClientHisData() {
         return { EpisodeId: $("#hdEpisodeId").val() };
     }

     $(".apptclientdp").kendoValidator({
         rules: {
             dateValidation: function (element) {
                 $(this).removeClass('field-validation-error');
                 $(this).parent().find('span[data-valmsg-for]').remove();
                 if (element.is("[data-val-date]") && element.val() != "") {
                     var value = $(element).val();
                     return is_valid_date(value);
                 }
                 return true;
             }
         },
         messages: {
             dateValidation: "must be a valid date",
         }
     });
     $(".apptclientdp").kendoMaskedTextBox({
         mask: "00/00/0000"
     });
     $(".apptclientdp").closest(".k-datepicker")
            .add($(".apptclientdp"))
            .removeClass("k-textbox")

    </script>

    @Html.HiddenFor(m=>m.EpisodeId, new { @id= "hdEpisodeId" })
    @(Html.Kendo().TabStrip()
         .Name("appttabstrip")
         .Events(e=> { e.Activate("tabChanged"); e.Select("tabChanged"); })
         .HtmlAttributes(new { style = "width:100%;min-height:300px; padding: 0; height:auto;" })
         .Animation(animation =>
             animation.Open(effect =>
                 effect.Fade(FadeDirection.In)))
      .Items(tabstrip =>
      {
      tabstrip.Add().Text("ALL APPOINTMENTS").Selected(true).Content(
        @Html.Partial("_ClientAllActivity", @Model).ToHtmlString()).HtmlAttributes(new { style = "padding:0px;" });
      tabstrip.Add().Text("DAILY ACTIVITY REPORT").Content(
        @Html.Partial("_ClientDailyActivity", @Model).ToHtmlString());
          if(Model.AppointmentDay == 0)
          {
              tabstrip.Add().Text("Back to dashboard").HtmlAttributes(new { style = "float:right;" });
          }
          else
          {
              tabstrip.Add().Text("Back to Social Work").HtmlAttributes(new { style = "float:right;" });
          }
      }
    ))
@*</div>*@


